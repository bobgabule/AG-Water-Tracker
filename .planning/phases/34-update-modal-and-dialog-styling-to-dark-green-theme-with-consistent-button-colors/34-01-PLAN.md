---
phase: 34-update-modal-and-dialog-styling-to-dark-green-theme-with-consistent-button-colors
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/index.css
  - src/components/ConfirmDialog.tsx
  - src/components/LocationSoftAskModal.tsx
  - src/components/WellLimitModal.tsx
  - src/components/MapOfflineOverlay.tsx
  - src/components/Button.tsx
autonomous: true
requirements: []

must_haves:
  truths:
    - "All centered dialog modals (ConfirmDialog, LocationSoftAskModal, WellLimitModal) have dark green backgrounds matching the app theme"
    - "The LocationSoftAskModal 'Allow' button uses the primary action color (#b6e5d1 bg, #3b6454 text)"
    - "The MapOfflineOverlay info card and legend pill use dark green backgrounds instead of gray-800"
    - "ConfirmDialog destructive confirm button remains red for UX safety"
    - "Primary action button token values match user-specified colors (#b6e5d1 and #3b6454)"
  artifacts:
    - path: "src/index.css"
      provides: "Updated btn-confirm and btn-confirm-text token values"
      contains: "--color-btn-confirm: #b6e5d1"
    - path: "src/components/ConfirmDialog.tsx"
      provides: "Dark green dialog background with adapted cancel button"
      contains: "bg-surface-modal"
    - path: "src/components/LocationSoftAskModal.tsx"
      provides: "Dark green dialog with green Allow button and green icon"
      contains: "bg-btn-confirm"
    - path: "src/components/WellLimitModal.tsx"
      provides: "Dark green dialog background"
      contains: "bg-surface-modal"
    - path: "src/components/MapOfflineOverlay.tsx"
      provides: "Dark green overlay cards"
      contains: "bg-surface-modal"
  key_links:
    - from: "src/index.css"
      to: "all modal components"
      via: "Tailwind @theme tokens"
      pattern: "bg-btn-confirm.*text-btn-confirm-text"
---

<objective>
Update all modal/dialog backgrounds from dark blue-gray (bg-gray-800) to dark green (bg-surface-modal) and set primary action buttons to #b6e5d1 background with #3b6454 text, creating visual consistency across the entire app.

Purpose: The app currently has inconsistent modal styling -- bottom sheets use green backgrounds while centered dialogs use gray-800. This phase unifies them all to the dark green theme and updates the primary action button colors to the user-specified values.

Output: All modals and dialog popups use dark green backgrounds with consistent button styling.
</objective>

<execution_context>
@C:/Users/Bobits/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Bobits/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/index.css
@src/components/ConfirmDialog.tsx
@src/components/LocationSoftAskModal.tsx
@src/components/WellLimitModal.tsx
@src/components/MapOfflineOverlay.tsx
@src/components/Button.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update color tokens and Button ghost variant</name>
  <files>src/index.css, src/components/Button.tsx</files>
  <action>
In `src/index.css`, update the @theme block:
- Change `--color-btn-confirm: #bdefda` to `--color-btn-confirm: #b6e5d1`
- Change `--color-btn-confirm-text: #506741` to `--color-btn-confirm-text: #3b6454`
- Add a new token `--color-surface-modal-lighter: #637a4d` for cancel/secondary button backgrounds inside dark green modals (slightly lighter than surface-modal #526640, providing visual contrast without reverting to gray). This replaces bg-gray-700 in dialog cancel buttons.

In `src/components/Button.tsx`, update the ghost variant to use the new modal-friendly color:
- Change `ghost: 'bg-gray-700 hover:bg-gray-600 text-gray-300'` to `ghost: 'bg-surface-modal-lighter hover:bg-surface-header text-white/70'`

This ensures the reusable Button component's ghost variant is consistent with the dark green theme if used in future dialogs.
  </action>
  <verify>
    <automated>npx tsc -b --noEmit</automated>
    <manual>Verify index.css contains the updated token values</manual>
  </verify>
  <done>btn-confirm is #b6e5d1, btn-confirm-text is #3b6454, surface-modal-lighter token exists, Button ghost variant uses green-themed colors</done>
</task>

<task type="auto">
  <name>Task 2: Migrate all dialog/modal backgrounds and button colors to green theme</name>
  <files>src/components/ConfirmDialog.tsx, src/components/LocationSoftAskModal.tsx, src/components/WellLimitModal.tsx, src/components/MapOfflineOverlay.tsx</files>
  <action>
**ConfirmDialog.tsx** (destructive confirmation dialog):
- Line 34: Change `bg-gray-800` to `bg-surface-modal` on DialogPanel
- Line 45: Change `text-gray-400` to `text-white/60` on description paragraph
- Line 53: Change cancel button from `text-gray-300 bg-gray-700 hover:bg-gray-600` to `text-white/70 bg-surface-modal-lighter hover:bg-surface-header`
- KEEP the red confirm button (`bg-red-600 hover:bg-red-700`) since ConfirmDialog is used exclusively for destructive actions (delete well, delete reading, delete allocation). Red on green background is correct UX for danger actions.

**LocationSoftAskModal.tsx** (location permission prompt):
- Line 26: Change `bg-gray-800` to `bg-surface-modal` on DialogPanel
- Line 30: Change prompt mode icon background from `bg-blue-500/20` to `bg-btn-confirm/30` and icon from `text-blue-400` to `text-btn-confirm`
- Line 43: Change `text-gray-400` to `text-white/60` on description paragraph
- Line 55: Change "No Thanks" cancel button from `text-gray-300 bg-gray-700 hover:bg-gray-600` to `text-white/70 bg-surface-modal-lighter hover:bg-surface-header`
- Line 63: Change "Allow" primary button from `text-white bg-blue-600 hover:bg-blue-700` to `bg-btn-confirm text-btn-confirm-text hover:opacity-90`
- Line 73: Change "Got It" button (denied mode) from `text-gray-300 bg-gray-700 hover:bg-gray-600` to `text-white/70 bg-surface-modal-lighter hover:bg-surface-header`

**WellLimitModal.tsx** (well limit upsell dialog):
- Line 26: Change `bg-gray-800` to `bg-surface-modal` on DialogPanel
- Line 31: Change close button from `text-gray-400 hover:text-white hover:bg-gray-700` to `text-white/60 hover:text-white hover:bg-surface-modal-lighter`
- Line 41: Change `text-gray-400` to `text-white/60` on description paragraph

**MapOfflineOverlay.tsx** (map offline info card):
- Line 30: Change `bg-gray-800/95 border border-gray-700` to `bg-surface-modal/95 border border-white/10`
- Line 37: Change `text-gray-400` to `text-white/60` on secondary text paragraph
- Line 60: Change `bg-gray-800/90` to `bg-surface-modal/90` on bottom legend pill
- Line 62: Change `text-gray-300` to `text-white/70` on legend text

After all changes, run the code-reviewer agent on the 4 modified component files.
  </action>
  <verify>
    <automated>npx tsc -b --noEmit</automated>
    <manual>Search codebase for remaining bg-gray-800 in modal/dialog components -- only non-modal usages (SettingsPage sections, WellDetailHeader placeholders, LazyErrorBoundary, FarmSelector, WellAllocationsPage backdrop) should remain</manual>
  </verify>
  <done>All 4 dialog/modal components use bg-surface-modal instead of bg-gray-800. LocationSoftAskModal "Allow" button uses bg-btn-confirm/text-btn-confirm-text. Cancel buttons use surface-modal-lighter. Description text uses text-white/60. No type errors.</done>
</task>

</tasks>

<verification>
1. `npx tsc -b --noEmit` passes with zero errors
2. `grep -r "bg-gray-800" src/components/ConfirmDialog.tsx src/components/LocationSoftAskModal.tsx src/components/WellLimitModal.tsx` returns no matches
3. `grep -r "bg-blue-600" src/components/LocationSoftAskModal.tsx` returns no matches
4. `grep "btn-confirm: #b6e5d1" src/index.css` returns a match
5. `grep "btn-confirm-text: #3b6454" src/index.css` returns a match
6. MapOfflineOverlay no longer contains bg-gray-800
</verification>

<success_criteria>
- All centered dialog modals (ConfirmDialog, LocationSoftAskModal, WellLimitModal) use bg-surface-modal (dark green #526640)
- MapOfflineOverlay info card and legend use bg-surface-modal
- LocationSoftAskModal "Allow" button uses bg-btn-confirm (#b6e5d1) with text-btn-confirm-text (#3b6454)
- ConfirmDialog destructive confirm button remains red (bg-red-600) -- intentionally NOT green for delete confirmations
- Cancel/secondary buttons in all dialogs use bg-surface-modal-lighter (new token) instead of bg-gray-700
- Description text in all dialogs uses text-white/60 instead of text-gray-400
- Button component ghost variant uses modal-friendly green theme colors
- `npx tsc -b --noEmit` passes with zero errors
- App visually matches: dark green modals with green primary action buttons (except red for destructive)
</success_criteria>

<output>
After completion, create `.planning/phases/34-update-modal-and-dialog-styling-to-dark-green-theme-with-consistent-button-colors/34-01-SUMMARY.md`
</output>
