---
phase: 32-unified-design-system-and-theme-colors
plan: 02
type: execute
wave: 2
depends_on: ["32-01"]
files_modified:
  - src/components/ConfirmDialog.tsx
  - src/components/Button.tsx
  - src/components/ConfirmDeleteWellDialog.tsx
  - src/components/ConfirmDeleteReadingDialog.tsx
  - src/components/ConfirmDeleteMemberDialog.tsx
  - src/components/ConfirmDeleteAllocationDialog.tsx
  - src/pages/WellEditPage.tsx
  - src/pages/WellAllocationsPage.tsx
  - src/pages/UsersPage.tsx
  - src/components/EditReadingSheet.tsx
autonomous: true
requirements: []

must_haves:
  truths:
    - "All 4 confirm delete dialogs use a single shared ConfirmDialog component"
    - "The 4 old ConfirmDelete*Dialog.tsx files no longer exist"
    - "Button component renders 5 variants (confirm, danger, ghost, dark, teal) with loading spinner"
    - "Callers of the old dialogs work identically after migration"
  artifacts:
    - path: "src/components/ConfirmDialog.tsx"
      provides: "Reusable confirm dialog with configurable title, description, confirm text, and loading"
      exports: ["default"]
    - path: "src/components/Button.tsx"
      provides: "Reusable button with variant prop and loading spinner"
      exports: ["default"]
  key_links:
    - from: "src/pages/WellEditPage.tsx"
      to: "src/components/ConfirmDialog.tsx"
      via: "import ConfirmDialog"
      pattern: "ConfirmDialog"
    - from: "src/pages/WellAllocationsPage.tsx"
      to: "src/components/ConfirmDialog.tsx"
      via: "import ConfirmDialog"
      pattern: "ConfirmDialog"
    - from: "src/components/EditReadingSheet.tsx"
      to: "src/components/ConfirmDialog.tsx"
      via: "import ConfirmDialog"
      pattern: "ConfirmDialog"
    - from: "src/pages/UsersPage.tsx"
      to: "src/components/ConfirmDialog.tsx"
      via: "import ConfirmDialog"
      pattern: "ConfirmDialog"
---

<objective>
Extract a shared ConfirmDialog component (replacing 4 identical dialogs) and a Button component (5 variants). Replace all callers and tokenize hex values in touched files.

Purpose: Eliminate 4 copy-pasted dialog files and establish reusable button patterns.
Output: 2 new shared components, 4 deleted files, 4 updated callers with tokenized colors.
</objective>

<execution_context>
@C:/Users/Bobits/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Bobits/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/32-unified-design-system-and-theme-colors/32-01-SUMMARY.md
@src/components/ConfirmDeleteWellDialog.tsx
@src/components/ConfirmDeleteMemberDialog.tsx
@src/index.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ConfirmDialog and Button shared components</name>
  <files>
    src/components/ConfirmDialog.tsx
    src/components/Button.tsx
  </files>
  <action>
**ConfirmDialog.tsx** -- Create a reusable confirm dialog component that replaces all 4 identical ConfirmDelete*Dialog files. Use Headless UI Dialog/DialogBackdrop/DialogPanel/DialogTitle with `data-[closed]:` transition attributes (v2 pattern).

Props interface:
```typescript
interface ConfirmDialogProps {
  open: boolean;
  onClose: () => void;
  onConfirm: () => void;
  title: string;
  description: React.ReactNode;  // ReactNode to support inline <span> formatting
  confirmText: string;           // e.g., "Delete", "Remove"
  confirmLoadingText: string;    // e.g., "Deleting...", "Removing..."
  loading: boolean;
}
```

Structure matches existing dialogs exactly:
- z-50 Dialog with bg-black/50 backdrop (data-[closed]:opacity-0)
- bg-gray-800 rounded-2xl DialogPanel (data-[closed]:scale-95, data-[closed]:opacity-0)
- Red warning icon circle (bg-red-500/20 with ExclamationTriangleIcon)
- Title + description + Cancel/Confirm buttons
- Cancel: bg-gray-700 hover:bg-gray-600 text-gray-300
- Confirm: bg-red-600 hover:bg-red-700 text-white with loading spinner
- Loading spinner: 4px white border with transparent top border, animate-spin

Export as default.

**Button.tsx** -- Create a reusable button with variant styling. Use @theme tokens from Plan 01.

Props interface:
```typescript
interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant: 'confirm' | 'danger' | 'ghost' | 'dark' | 'teal';
  loading?: boolean;
  loadingText?: string;
  fullWidth?: boolean;
}
```

Variant styles (all use tokens from @theme):
- **confirm**: `bg-btn-confirm text-btn-confirm-text` -- the green mint save/submit button used across many forms
- **danger**: `bg-red-600 hover:bg-red-700 text-white` -- delete/remove actions
- **ghost**: `bg-gray-700 hover:bg-gray-600 text-gray-300` -- cancel buttons in dark dialogs
- **dark**: `bg-btn-dark active:bg-btn-dark-active text-white` -- dark green buttons (allocations save)
- **teal**: `bg-teal text-white hover:bg-teal-hover` -- teal action buttons (new well)

Common classes: `py-2.5 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2`

When `fullWidth` is true, add `w-full`.

When `loading` is true:
- Show spinner (w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin)
- Show loadingText if provided, otherwise show children
- Set disabled=true automatically

Use `React.forwardRef` for the button ref. Export as default.
  </action>
  <verify>
    <automated>npx tsc -b --noEmit</automated>
    <manual>Verify both files exist and export correct interfaces</manual>
  </verify>
  <done>ConfirmDialog.tsx and Button.tsx exist with correct props interfaces and compile without errors</done>
</task>

<task type="auto">
  <name>Task 2: Replace 4 confirm dialog callers and tokenize hex values</name>
  <files>
    src/pages/WellEditPage.tsx
    src/pages/WellAllocationsPage.tsx
    src/pages/UsersPage.tsx
    src/components/EditReadingSheet.tsx
    src/components/ConfirmDeleteWellDialog.tsx
    src/components/ConfirmDeleteReadingDialog.tsx
    src/components/ConfirmDeleteMemberDialog.tsx
    src/components/ConfirmDeleteAllocationDialog.tsx
  </files>
  <action>
**Step 1: Replace all 4 confirm dialog usages with ConfirmDialog.**

In each caller file, update the import and JSX:

**WellEditPage.tsx:**
- Change `import ConfirmDeleteWellDialog from '../components/ConfirmDeleteWellDialog'` to `import ConfirmDialog from '../components/ConfirmDialog'`
- Replace `<ConfirmDeleteWellDialog ... wellName={...} />` with:
  ```tsx
  <ConfirmDialog
    open={...}
    onClose={...}
    onConfirm={...}
    title="Delete Well"
    description={<>Delete <span className="text-white font-medium">{wellName}</span> and all its readings and allocations? This cannot be undone.</>}
    confirmText="Delete"
    confirmLoadingText="Deleting..."
    loading={...}
  />
  ```

**WellAllocationsPage.tsx:**
- Change import to ConfirmDialog
- title="Delete Allocation", description uses periodLabel variable with inline span, confirmText="Delete", confirmLoadingText="Deleting..."

**EditReadingSheet.tsx:**
- Change import to ConfirmDialog
- title="Delete Reading", description uses readingValue and readingDate with inline spans, confirmText="Delete", confirmLoadingText="Deleting..."

**UsersPage.tsx:**
- Change import to ConfirmDialog
- title="Remove User", description uses memberName with inline span, confirmText="Remove", confirmLoadingText="Removing..."

**Step 2: Delete the 4 old files:**
- src/components/ConfirmDeleteWellDialog.tsx
- src/components/ConfirmDeleteReadingDialog.tsx
- src/components/ConfirmDeleteMemberDialog.tsx
- src/components/ConfirmDeleteAllocationDialog.tsx

**Step 3: Tokenize hardcoded hex in the 4 caller files.**

Replace hex values with @theme token classes:

| Old | New |
|-----|-----|
| `bg-[#5f7248]` | `bg-surface-header` |
| `bg-[#4e6339]` or `hover:bg-[#4e6339]` | `hover:bg-surface-header-hover` |
| `bg-[#bdefda]` | `bg-btn-confirm` |
| `text-[#506741]` | `text-btn-confirm-text` |
| `border-[#506741]` | `border-btn-confirm-text` |
| `bg-[#3d5030]` | `bg-btn-dark` |
| `active:bg-[#334428]` | `active:bg-btn-dark-active` |
| `text-[#e8937c]` | `text-text-coral` |
| `text-[#6190d1]` | `text-accent-gps` |
| `hover:bg-[#6190d1]` | `hover:bg-accent-gps` |
| `bg-[#c5cdb4]` | `bg-surface-page` |
| `from-[#c5cdb4]` | `from-surface-page` |
| `via-[#c5cdb4]` | `via-surface-page` |
| `text-[#5f7248]` | `text-text-heading` |
| `bg-[#dfe4d4]` | `bg-surface-card` |

Apply all replacements. Do NOT change any hex in AuthLayout.tsx (not in this plan's scope).

Verify no `#` hex literals remain in the 4 caller files (except inside comments).
  </action>
  <verify>
    <automated>npx tsc -b --noEmit</automated>
    <manual>Verify 4 old dialog files deleted, 4 callers use ConfirmDialog, no hex in callers</manual>
  </verify>
  <done>All 4 confirm dialog usages migrated to shared ConfirmDialog, old files deleted, all hex in caller files replaced with tokens</done>
</task>

</tasks>

<verification>
1. `npx tsc -b --noEmit` passes
2. Files ConfirmDeleteWellDialog.tsx, ConfirmDeleteReadingDialog.tsx, ConfirmDeleteMemberDialog.tsx, ConfirmDeleteAllocationDialog.tsx no longer exist
3. ConfirmDialog.tsx and Button.tsx exist in src/components/
4. No hardcoded hex (#xxxxxx) in WellEditPage, WellAllocationsPage, EditReadingSheet, UsersPage
5. Dialogs render identically (same layout, colors, animations)
</verification>

<success_criteria>
4 copy-pasted dialogs consolidated into 1 shared ConfirmDialog. Button component with 5 variants available for use. All touched files use @theme tokens.
</success_criteria>

<output>
After completion, create `.planning/phases/32-unified-design-system-and-theme-colors/32-02-SUMMARY.md`
</output>
