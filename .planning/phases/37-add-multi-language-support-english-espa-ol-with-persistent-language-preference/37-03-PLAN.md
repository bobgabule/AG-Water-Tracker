---
phase: 37-add-multi-language-support-english-espa-ol-with-persistent-language-preference
plan: 03
type: execute
wave: 2
depends_on: ["37-01"]
files_modified:
  - src/pages/DashboardPage.tsx
  - src/pages/WellListPage.tsx
  - src/pages/WellDetailPage.tsx
  - src/pages/WellEditPage.tsx
  - src/pages/WellAllocationsPage.tsx
  - src/pages/UsersPage.tsx
  - src/pages/SettingsPage.tsx
  - src/pages/ReportsPage.tsx
  - src/pages/SubscriptionPage.tsx
  - src/components/AddWellFormBottomSheet.tsx
  - src/components/WellDetailHeader.tsx
  - src/components/WellDetailSheet.tsx
  - src/components/WellUsageGauge.tsx
  - src/components/WellStatusIndicators.tsx
  - src/components/WellReadingsList.tsx
  - src/components/NewReadingSheet.tsx
  - src/components/EditReadingSheet.tsx
  - src/components/AddUserModal.tsx
  - src/components/PendingInvitesList.tsx
autonomous: true
requirements:
  - I18N-WELLS-PAGES

must_haves:
  truths:
    - "Well list page shows translated column headers and empty state in Spanish"
    - "Well detail page shows translated gauge labels (Allocated/Asignado, Used/Usado, Remaining/Restante) and section headings"
    - "New Reading and Edit Reading sheets show translated form labels and validation messages"
    - "Well allocations page shows translated table headers and form labels"
    - "Users page shows translated role names via getRoleDisplayName(role, locale)"
    - "Settings, Reports, and Subscription pages show translated headings and content"
    - "All relative time displays (Today, Yesterday, X days ago) render in the selected locale"
    - "All toLocaleDateString calls use locale from useTranslation, not hardcoded 'en-US'"
    - "Equipment states, well statuses, and unit types show translated display labels"
  artifacts:
    - path: "src/pages/WellListPage.tsx"
      provides: "Translated well list with headers and empty state"
      contains: "useTranslation"
    - path: "src/components/WellUsageGauge.tsx"
      provides: "Translated gauge labels"
      contains: "useTranslation"
    - path: "src/components/NewReadingSheet.tsx"
      provides: "Translated reading form"
      contains: "useTranslation"
    - path: "src/pages/UsersPage.tsx"
      provides: "Translated user management with role names"
      contains: "getRoleDisplayName"
  key_links:
    - from: "src/pages/UsersPage.tsx"
      to: "src/lib/permissions.ts"
      via: "getRoleDisplayName(role, locale) for role pills"
      pattern: "getRoleDisplayName"
    - from: "src/components/WellUsageGauge.tsx"
      to: "src/hooks/useTranslation.ts"
      via: "t() for Allocated/Used/Remaining labels"
      pattern: "t\\('well\\."
    - from: "src/components/WellReadingsList.tsx"
      to: "src/hooks/useTranslation.ts"
      via: "t() for relative time and reading labels"
      pattern: "t\\('time\\."
---

<objective>
Wire translations into all well management pages, well detail components, reading forms, user management, and remaining data pages (Settings, Reports, Subscription). After this plan, every user-facing string in the app speaks the selected language.

Purpose: This completes the i18n rollout across all data-heavy pages and components.
Output: 19 modified files with full translation coverage.
</objective>

<execution_context>
@C:/Users/Bobits/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Bobits/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/37-add-multi-language-support-english-espa-ol-with-persistent-language-preference/37-CONTEXT.md
@.planning/phases/37-add-multi-language-support-english-espa-ol-with-persistent-language-preference/37-01-SUMMARY.md

# Key files to read for string extraction:
@src/pages/DashboardPage.tsx
@src/pages/WellListPage.tsx
@src/pages/WellDetailPage.tsx
@src/pages/WellEditPage.tsx
@src/pages/WellAllocationsPage.tsx
@src/pages/UsersPage.tsx
@src/pages/SettingsPage.tsx
@src/pages/ReportsPage.tsx
@src/pages/SubscriptionPage.tsx
@src/components/AddWellFormBottomSheet.tsx
@src/components/WellDetailHeader.tsx
@src/components/WellDetailSheet.tsx
@src/components/WellUsageGauge.tsx
@src/components/WellStatusIndicators.tsx
@src/components/WellReadingsList.tsx
@src/components/NewReadingSheet.tsx
@src/components/EditReadingSheet.tsx
@src/components/AddUserModal.tsx
@src/components/PendingInvitesList.tsx
@src/lib/permissions.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Wire translations into well pages and well detail components</name>
  <files>
    src/pages/DashboardPage.tsx
    src/pages/WellListPage.tsx
    src/pages/WellDetailPage.tsx
    src/pages/WellEditPage.tsx
    src/pages/WellAllocationsPage.tsx
    src/components/AddWellFormBottomSheet.tsx
    src/components/WellDetailHeader.tsx
    src/components/WellDetailSheet.tsx
    src/components/WellUsageGauge.tsx
    src/components/WellStatusIndicators.tsx
    src/components/WellReadingsList.tsx
    src/components/NewReadingSheet.tsx
    src/components/EditReadingSheet.tsx
  </files>
  <action>
For each file, add `import { useTranslation } from '../hooks/useTranslation'` (or `'../../hooks/useTranslation'` depending on depth), call `const { t, locale } = useTranslation()` inside the component, then replace all hardcoded English strings with `t('key')` calls. Also update all `toLocaleDateString('en-US', ...)` to `toLocaleDateString(locale, ...)`.

**DashboardPage.tsx:**
- Any visible text labels, button text, empty states
- Toast messages for well creation success/failure -> `t('toast.wellCreated')`, `t('toast.wellCreateError')`
- "Add Well" button text if visible -> `t('well.addWell')`

**WellListPage.tsx:**
- Page title: "Well List" -> `t('nav.wellList')`
- Empty state: "No wells found" -> `t('well.noWells')`
- Column headers or list item labels
- "Add Well" button -> `t('well.addWell')`
- Date displays: use `locale` for `toLocaleDateString`

**WellDetailPage.tsx:**
- Section headings, labels
- Any inline text
- Date displays: use `locale`

**WellEditPage.tsx:**
- Page title: "Edit Well" -> `t('well.editWell')`
- Form labels: Serial Number -> `t('well.serialNumber')`, Well Name -> `t('well.wellName')`, Permit Number -> `t('well.permitNumber')`, State -> `t('well.state')`, County -> `t('well.county')`, Township -> `t('well.township')`, Range -> `t('well.range')`, Section -> `t('well.section')`, Quarter -> `t('well.quarter')`, Unit Type -> `t('well.unitType')`, Status -> `t('well.status')`, Latitude -> `t('well.latitude')`, Longitude -> `t('well.longitude')`
- Buttons: Save -> `t('common.save')`, Cancel -> `t('common.cancel')`, Delete -> `t('common.delete')`
- Status options: Active -> `t('well.status.active')`, Inactive -> `t('well.status.inactive')`, Abandoned -> `t('well.status.abandoned')`
- Unit type options: Gallons -> `t('well.unitType.gallons')`, Cubic Feet -> `t('well.unitType.cubicFeet')`, Acre-Feet -> `t('well.unitType.acreFeet')`
- Validation errors: use `t('error.required')`, etc.
- Toast messages: `t('toast.wellUpdated')`, `t('toast.wellDeleted')`

**WellAllocationsPage.tsx:**
- Page title: "Allocations" -> `t('allocation.title')`
- Table headers: Start Date, End Date, Allocated, Used, Remaining
- "New Allocation" button -> `t('allocation.new')`
- Empty state -> `t('allocation.noAllocations')`
- Form labels, validation messages
- Date formatting: use `locale`
- Toast messages: `t('toast.allocationSaved')`, `t('toast.allocationDeleted')`

**AddWellFormBottomSheet.tsx:**
- Title: "Add Well" -> `t('well.addWell')`
- All form labels (same as WellEditPage field names)
- Buttons: Save, Cancel
- Validation messages
- GPS status text: "Capturing GPS..." -> `t('reading.gpsCapturing')`

**WellDetailHeader.tsx:**
- Labels, status text, well name display
- "Last Updated" label -> `t('well.lastUpdated')`

**WellDetailSheet.tsx:**
- Section headings, tab labels
- Any descriptive text

**WellUsageGauge.tsx:**
- "Allocated" -> `t('allocation.allocated')`
- "Used" -> `t('allocation.used')`
- "Remaining" -> `t('allocation.remaining')`
- "AF" unit label -> `t('well.unitType.af')` (or keep as-is if it's an abbreviation)
- Percentage labels

**WellStatusIndicators.tsx:**
- Equipment status labels: Ok -> `t('well.equipment.ok')`, Dead -> `t('well.equipment.dead')`, Low -> `t('well.equipment.low')`, Off -> `t('well.equipment.off')`
- Meter Problem label -> `t('reading.meterProblem')`
- Pump status labels

**WellReadingsList.tsx:**
- "Readings" heading -> `t('reading.readings')`
- "No readings yet" -> `t('reading.noReadings')`
- Relative time formatting: find any `formatRelativeDate` or inline date logic and wire through `t()` for "Today" -> `t('time.today')`, "Yesterday" -> `t('time.yesterday')`, plurals for days/weeks/months ago using `t('time.daysAgo', { count })`, `t('time.weeksAgo', { count })`, `t('time.monthsAgo', { count })`
- If there is a `formatRelativeDate` utility function, update it to accept `t` as a parameter (or `locale` and look up translations internally)
- Reading value labels, date formatting: use `locale`

**NewReadingSheet.tsx:**
- Title: "New Reading" -> `t('reading.newReading')`
- Form labels: Current Reading -> `t('reading.currentReading')`, Meter Problem -> `t('reading.meterProblem')`, Pump Off -> `t('reading.pumpOff')`, Dead Pump -> `t('reading.deadPump')`, Low Battery -> `t('reading.lowBattery')`
- "Save Reading" -> `t('reading.saveReading')`
- GPS status messages: "Capturing GPS..." -> `t('reading.gpsCapturing')`, "GPS failed" -> `t('reading.gpsFailed')`, "Save Without GPS" -> `t('reading.saveWithoutGps')`, "Retry" -> `t('common.retry')`
- Similar reading warning message -> `t('reading.similarWarning')`
- Validation errors

**EditReadingSheet.tsx:**
- Title: "Edit Reading" -> `t('reading.editReading')`
- Same form labels as NewReadingSheet
- "Delete Reading" -> `t('reading.deleteReading')`
- Confirmation dialog text: pass `t('reading.deleteConfirm')` to ConfirmDialog
  </action>
  <verify>
    <automated>npx tsc -b --noEmit</automated>
    <manual>Switch to Spanish. Open well list — verify headers, empty state, buttons in Spanish. Open a well detail — verify gauge labels say Asignado/Usado/Restante. Open new reading form — verify all labels in Spanish. Check relative dates show "Hoy", "Ayer", "hace X dias".</manual>
  </verify>
  <done>
    - All 13 well-related files use t() for every user-facing string
    - Equipment states, well statuses, unit types show translated labels
    - Relative time strings (Today, Yesterday, X days ago) render in selected locale
    - All toLocaleDateString calls use locale from useTranslation
    - Gauge labels show Allocated/Asignado, Used/Usado, Remaining/Restante
    - Form validation messages are translated
    - Toast notifications are translated
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire translations into Users, Settings, Reports, and Subscription pages</name>
  <files>
    src/pages/UsersPage.tsx
    src/pages/SettingsPage.tsx
    src/pages/ReportsPage.tsx
    src/pages/SubscriptionPage.tsx
    src/components/AddUserModal.tsx
    src/components/PendingInvitesList.tsx
  </files>
  <action>
For each file, add useTranslation import/hook call and replace hardcoded strings.

**UsersPage.tsx:**
- Page title: "Users" -> `t('user.title')`
- "Add User" button -> `t('user.addUser')`
- Role display: Replace `ROLE_DISPLAY_NAMES[role]` with `getRoleDisplayName(role, locale)` — import `getRoleDisplayName` from `../lib/permissions` and `locale` from `useTranslation()`
- User status labels: "Active" -> `t('user.active')`, "Disabled" -> `t('user.disabled')`
- Enable/Disable buttons -> `t('user.enable')`, `t('user.disable')`
- Empty state: "No users found" -> `t('user.noUsers')`
- Confirmation dialogs for disable/enable: pass translated strings
- Toast messages: `t('toast.userEnabled')`, `t('toast.userDisabled')`

**AddUserModal.tsx:**
- Title: "Add User" or "Invite User" -> `t('user.addUser')`
- Form labels: First Name -> `t('user.firstName')`, Last Name -> `t('user.lastName')`, Phone Number -> `t('auth.phoneNumber')`, Role -> `t('user.role')`
- Role options in dropdown: use `getRoleDisplayName(role, locale)` for each option label
- "Send Invite" button -> `t('user.sendInvite')`
- Cancel button -> `t('common.cancel')`
- Validation errors: `t('error.required')`, `t('error.invalidPhone')`
- Toast messages: `t('toast.inviteSent')`

**PendingInvitesList.tsx:**
- Title: "Pending Invites" -> `t('user.pendingInvites')`
- "Revoke" button -> `t('user.revoke')`
- Empty state text
- Role display: use `getRoleDisplayName(role, locale)`
- Confirmation dialog for revoke: pass translated strings
- Toast: `t('toast.inviteRevoked')`

**SettingsPage.tsx:**
- Page title: "Settings" -> `t('settings.title')`
- Section headings: Profile, Farm Settings, etc.
- Form labels, button text
- Any descriptive text
- Toast messages for save actions

**ReportsPage.tsx:**
- Page title: "Reports" -> `t('reports.title')`
- All labels, descriptions, empty states
- Date formatting: use `locale`
- Any report-specific terminology

**SubscriptionPage.tsx:**
- Page title: "Subscription" -> `t('subscription.title')`
- Tier names: Free -> `t('subscription.free')`, Starter -> `t('subscription.starter')`, Professional -> `t('subscription.professional')` (or keep tier names as brand names — use translation keys regardless for flexibility)
- Usage labels: "Wells" -> `t('subscription.wells')`, "Seats" -> `t('subscription.seats')`
- "Current Plan" -> `t('subscription.currentPlan')`
- Limit display text, upgrade prompts
- Role seat breakdown labels: use `getRoleDisplayName(role, locale)` where role names appear
  </action>
  <verify>
    <automated>npx tsc -b --noEmit</automated>
    <manual>Switch to Spanish. Open Users page — verify role names show Administrador/Lector de Medidores/Propietario. Open Settings — verify all labels in Spanish. Open Subscription — verify plan details in Spanish. Open Reports — verify all text in Spanish.</manual>
  </verify>
  <done>
    - All 6 files use t() and getRoleDisplayName() for every user-facing string
    - Role names display as translated labels (Administrador, Lector de Medidores, Propietario)
    - Pending invites list shows translated labels and actions
    - Settings, Reports, Subscription pages fully translated
    - All toLocaleDateString calls use locale
    - Toast notifications translated
    - npx tsc -b --noEmit passes
  </done>
</task>

</tasks>

<verification>
1. `npx tsc -b --noEmit` passes with zero errors
2. Switch language to Spanish, then systematically visit every page:
   - Dashboard: any visible labels in Spanish
   - Well List: headers, empty state, buttons in Spanish
   - Well Detail: gauge labels, readings, status indicators in Spanish
   - Well Edit: all form labels, validation, buttons in Spanish
   - Allocations: table headers, form, buttons in Spanish
   - New Reading: form labels, GPS status, warnings in Spanish
   - Users: role names, status, buttons in Spanish
   - Settings: all text in Spanish
   - Reports: all text in Spanish
   - Subscription: plan details, usage labels in Spanish
3. Relative dates show "Hoy", "Ayer", "hace X dias" in Spanish
4. All date displays use locale-aware formatting
5. Equipment states show Bueno/Muerta/Bajo/Apagada in Spanish
</verification>

<success_criteria>
- 19 files modified with complete translation coverage
- Every user-facing string in the app is wrapped in t() or uses getRoleDisplayName()
- Switching language at /language causes ALL pages to render in the selected language
- No hardcoded English user-facing strings remain in any component file
- Numbers remain in US format (1,234.56) regardless of language
</success_criteria>

<output>
After completion, create `.planning/phases/37-add-multi-language-support-english-espa-ol-with-persistent-language-preference/37-03-SUMMARY.md`
</output>
